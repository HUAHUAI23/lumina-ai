# åˆ†é•œè„šæœ¬å·¥ä½œæµç¨‹ (æ¨¡å¼ B)

æœ¬å·¥ä½œæµç”¨äºæ ¹æ®å¤šå¼ å›¾ç‰‡ç”Ÿæˆå®Œæ•´çš„åˆ†é•œè„šæœ¬ã€‚

---

## è§¦å‘æ¡ä»¶

- å›¾ç‰‡æ•°é‡ â‰¥ 3ï¼ˆç‹¬ç«‹å›¾ç‰‡ï¼‰
- ä¸Šä¼  1 å¼ ä¹å®«æ ¼/å¤šå®«æ ¼åˆæˆå›¾
- ç”¨æˆ·æè¿°å®Œæ•´æ•…äº‹/å¤šä¸ªåœºæ™¯
- å…³é”®è¯: åˆ†é•œã€è„šæœ¬ã€storyã€å¤šä¸ªé•œå¤´ã€å®Œæ•´è§†é¢‘

---

## ä¹å®«æ ¼å›¾ç‰‡å¤„ç† ğŸ”²

### Step G0: æ£€æµ‹ä¹å®«æ ¼

```
IF ç”¨æˆ·ä¸Šä¼  1 å¼ å›¾ç‰‡:
   åˆ†æå›¾ç‰‡æ˜¯å¦ä¸ºç½‘æ ¼å¸ƒå±€:
   - æ£€æµ‹è§„åˆ™ç½‘æ ¼çº¿
   - è¯†åˆ«æ ¼å­æ•°é‡ (2x2, 3x3, 4x4, ç­‰)
   - ç¡®å®šæ˜¯å¦ä¸ºåˆ†é•œé¢„è§ˆå›¾

IF æ£€æµ‹åˆ°ç½‘æ ¼å¸ƒå±€:
   â†’ è¿›å…¥æ„å›¾è¯†åˆ«æµç¨‹
ELSE:
   â†’ æ­£å¸¸å•å›¾å¤„ç†
```

---

### Step G1: æ„å›¾è¯†åˆ«ï¼ˆä¸‰å±‚æ–¹æ³•ï¼‰

#### å±‚çº§ 1: å…³é”®è¯æ£€æµ‹ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰

ä»ç”¨æˆ·æè¿°ä¸­æ£€æµ‹å…³é”®è¯ï¼Œç›´æ¥åˆ¤æ–­æ„å›¾ï¼š

**è§¦å‘åˆ†é•œæ¨¡å¼ï¼ˆæ¨¡å¼ Bï¼‰çš„å…³é”®è¯ï¼š**
```
åˆ†é•œã€è„šæœ¬ã€storyboardã€storyã€æ•…äº‹æ¿ã€é•œå¤´åºåˆ—ã€
æ¯æ ¼ä¸€ä¸ªé•œå¤´ã€æŒ‰é¡ºåºã€å™äº‹ã€å‰§æƒ…ã€æ—¶é—´çº¿ã€
å¤šä¸ªåœºæ™¯ã€å®Œæ•´è§†é¢‘ã€çŸ­ç‰‡
```

**è§¦å‘å•åœºæ™¯æ¨¡å¼ï¼ˆæ¨¡å¼ Aï¼‰çš„å…³é”®è¯ï¼š**
```
å‚è€ƒã€referenceã€ä¸åŒè§’åº¦ã€åŒä¸€åœºæ™¯ã€è§’è‰²è¡¨æƒ…ã€
è¡¨æƒ…åŒ…ã€å§¿æ€å‚è€ƒã€åŠ¨ä½œå‚è€ƒã€è§’è‰²è®¾è®¡ã€æ¦‚å¿µå›¾ã€
mood boardã€æƒ…ç»ªæ¿ã€é£æ ¼å‚è€ƒ
```

**åˆ¤æ–­é€»è¾‘ï¼š**
```python
if any(keyword in user_text for keyword in storyboard_keywords):
    return MODE_B_STORYBOARD
elif any(keyword in user_text for keyword in reference_keywords):
    return MODE_A_SINGLE
else:
    â†’ è¿›å…¥å±‚çº§2ç”»é¢åˆ†æ
```

---

#### å±‚çº§ 2: ç”»é¢å†…å®¹åˆ†æï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

å½“å…³é”®è¯ä¸æ˜ç¡®æ—¶ï¼Œåˆ†æä¹å®«æ ¼çš„**ç”»é¢å†…å®¹å…³ç³»**ï¼š

**åˆ¤æ–­ä¸ºåˆ†é•œæ•…äº‹çš„ç‰¹å¾ï¼š**
```
â–¡ æ¯æ ¼èƒŒæ™¯/åœ°ç‚¹ä¸åŒ
â–¡ ç”»é¢å‘ˆç°æ—¶é—´å…ˆåé¡ºåº
â–¡ æ ¼å­ä¹‹é—´æœ‰å› æœ/å™äº‹å…³ç³»
â–¡ äººç‰©ä½ç½®/åŠ¨ä½œæœ‰æ˜æ˜¾å˜åŒ–ï¼ˆåŠ¨æ€åºåˆ—ï¼‰
â–¡ æ™¯åˆ«æœ‰å˜åŒ–ï¼ˆè¿œâ†’è¿‘â†’ç‰¹å†™ï¼‰
â–¡ æ ¼å­ä¹‹é—´æœ‰è§†è§‰è½¬åœºæš—ç¤º
```

**åˆ¤æ–­ä¸ºå•åœºæ™¯å‚è€ƒçš„ç‰¹å¾ï¼š**
```
â–¡ æ¯æ ¼æ˜¯åŒä¸€äººç‰©çš„ä¸åŒè¡¨æƒ…
â–¡ æ¯æ ¼æ˜¯åŒä¸€åœºæ™¯çš„ä¸åŒè§’åº¦
â–¡ æ¯æ ¼æ˜¯åŒä¸€åŠ¨ä½œçš„åˆ†è§£å¸§
â–¡ æ¯æ ¼é£æ ¼/è‰²è°ƒç»Ÿä¸€ä½†å†…å®¹ä¸è¿ç»­
â–¡ ç±»ä¼¼è§’è‰²è®¾è®¡è¡¨/åŠ¨ä½œå‚è€ƒè¡¨
â–¡ æ— æ˜æ˜¾å™äº‹é¡ºåº
```

**åˆ†ææç¤ºæ¨¡æ¿ï¼ˆç»™è§†è§‰æ¨¡å‹ï¼‰ï¼š**
```
è¯·åˆ†æè¿™å¼ ä¹å®«æ ¼å›¾ç‰‡ï¼Œåˆ¤æ–­å®ƒå±äºå“ªç§ç±»å‹ï¼š

åˆ†ææ¯ä¸ªæ ¼å­ï¼š
1. æ¯æ ¼çš„èƒŒæ™¯/åœºæ™¯æ˜¯å¦ç›¸åŒï¼Ÿ
2. æ¯æ ¼ä¹‹é—´æ˜¯å¦æœ‰æ—¶é—´å…ˆåå…³ç³»ï¼Ÿ
3. æ¯æ ¼çš„äººç‰©/ä¸»ä½“æ˜¯å¦åœ¨è¿›è¡Œè¿ç»­åŠ¨ä½œï¼Ÿ
4. æ¯æ ¼ä¹‹é—´æ˜¯å¦æœ‰å™äº‹é€»è¾‘ï¼ˆèµ·å› â†’ç»è¿‡â†’ç»“æœï¼‰ï¼Ÿ

æ ¹æ®ä»¥ä¸Šåˆ†æåˆ¤æ–­ï¼š
- è‹¥ç­”æ¡ˆå"æ˜¯" â†’ åˆ†é•œæ•…äº‹ï¼ˆæ¯æ ¼=1é•œå¤´ï¼‰
- è‹¥ç­”æ¡ˆå"å¦" â†’ å‚è€ƒå›¾ï¼ˆæ•´ä½“=1å‚è€ƒï¼‰
```

---

#### å±‚çº§ 3: ä¸»åŠ¨è¯¢é—®ç”¨æˆ·ï¼ˆæ— æ³•åˆ¤æ–­æ—¶ï¼‰

å½“å±‚çº§1å’Œå±‚çº§2éƒ½æ— æ³•ç¡®å®šæ—¶ï¼Œä¸»åŠ¨è¯¢é—®ï¼š

```
æˆ‘æ£€æµ‹åˆ°æ‚¨ä¸Šä¼ äº†ä¸€å¼  [NÃ—M] çš„ä¹å®«æ ¼å›¾ç‰‡ï¼ˆå…± X ä¸ªæ ¼å­ï¼‰ã€‚

ä¸ºäº†å‡†ç¡®ç†è§£æ‚¨çš„éœ€æ±‚ï¼Œè¯·å‘Šè¯‰æˆ‘è¿™å¼ å›¾çš„ç”¨é€”ï¼š

A) **åˆ†é•œé¢„è§ˆå›¾ / æ•…äº‹æ¿**
   æ¯ä¸ªæ ¼å­æ˜¯ä¸€ä¸ªç‹¬ç«‹é•œå¤´ï¼Œæˆ‘å°†æŒ‰é¡ºåºä¸ºæ¯æ ¼ç”Ÿæˆæç¤ºè¯ï¼Œ
   ç»„æˆå®Œæ•´çš„åˆ†é•œè„šæœ¬ï¼ˆåŒ…å«è½¬åœºã€æ—¶é•¿å»ºè®®ï¼‰

B) **è§’è‰²å‚è€ƒ / åœºæ™¯å‚è€ƒ**  
   9ä¸ªæ ¼å­å±•ç¤ºåŒä¸€å†…å®¹çš„ä¸åŒæ–¹é¢ï¼Œæˆ‘å°†æŠŠæ•´ä½“ä½œä¸ºå‚è€ƒï¼Œ
   ç”Ÿæˆå•ä¸ªè§†é¢‘æç¤ºè¯

C) **è®©æˆ‘æè¿°å…·ä½“éœ€æ±‚**
   å¦‚æœä»¥ä¸Šéƒ½ä¸ç¬¦åˆï¼Œè¯·å‘Šè¯‰æˆ‘æ‚¨æƒ³è¦ä»€ä¹ˆ

è¯·å›å¤ Aã€B æˆ– Cã€‚
```

---

### Step G2: è™šæ‹Ÿæ‹†åˆ†ï¼ˆåˆ†é•œæ¨¡å¼ï¼‰

ç¡®è®¤ä¸ºåˆ†é•œæ•…äº‹åï¼Œè¿›è¡Œè™šæ‹Ÿæ‹†åˆ†ï¼š

```
Step G2.1: è¯†åˆ«ç½‘æ ¼å¸ƒå±€
â”œâ”€â”€ æ£€æµ‹è¡Œåˆ—æ•° (rows Ã— cols)
â”œâ”€â”€ è®¡ç®—æ ¼å­æ€»æ•°
â””â”€â”€ ç¡®å®šé˜…è¯»é¡ºåºï¼ˆä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹ï¼‰

Step G2.2: ç”Ÿæˆä½ç½®æ˜ å°„
â”œâ”€â”€ ç¼–å·è§„åˆ™: [è¡Œ,åˆ—] â†’ Image N
â”œâ”€â”€ ç¬¬1è¡Œç¬¬1åˆ— = Image 1
â”œâ”€â”€ ç¬¬1è¡Œç¬¬2åˆ— = Image 2
â””â”€â”€ ...ä»¥æ­¤ç±»æ¨

Step G2.3: å†…å®¹åˆ†æ
â”œâ”€â”€ åˆ†ææ¯ä¸ªæ ¼å­çš„ç”»é¢å†…å®¹
â”œâ”€â”€ æ¨æ–­å™äº‹é¡ºåºï¼ˆé»˜è®¤æŒ‰ç¼–å·é¡ºåºï¼‰
â””â”€â”€ è¿›å…¥å¸¸è§„ Step B1 åˆ†é•œè§„åˆ’

ä½ç½®æ˜ å°„ç¤ºä¾‹ (3Ã—3):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image 1 â”‚ Image 2 â”‚ Image 3 â”‚
â”‚ [1,1]   â”‚ [1,2]   â”‚ [1,3]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Image 4 â”‚ Image 5 â”‚ Image 6 â”‚
â”‚ [2,1]   â”‚ [2,2]   â”‚ [2,3]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Image 7 â”‚ Image 8 â”‚ Image 9 â”‚
â”‚ [3,1]   â”‚ [3,2]   â”‚ [3,3]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step G3: å•åœºæ™¯å¤„ç†ï¼ˆå‚è€ƒæ¨¡å¼ï¼‰

ç¡®è®¤ä¸ºå‚è€ƒå›¾åï¼ŒæŒ‰æ¨¡å¼ A å¤„ç†ï¼š

```
å¤„ç†æ–¹å¼:
â”œâ”€â”€ æ•´å¼ ä¹å®«æ ¼ä½œä¸ºä¸€ä¸ªå‚è€ƒå›¾
â”œâ”€â”€ ç»¼åˆåˆ†ææ‰€æœ‰æ ¼å­çš„å…±åŒå…ƒç´ 
â”œâ”€â”€ æå–ä¸»è¦è§’è‰²ç‰¹å¾/åœºæ™¯ç‰¹å¾
â””â”€â”€ ç”Ÿæˆå•ä¸ªæç¤ºè¯

æç¤ºè¯ä¸­çš„æ ‡æ³¨:
â”œâ”€â”€ å¯æè¿°è§’è‰²çš„å¤šç§çŠ¶æ€ "showing various expressions"
â”œâ”€â”€ å¯æè¿°åœºæ™¯çš„å¤šè§’åº¦ "viewed from multiple angles"
â””â”€â”€ ä¿æŒå•ä¸ª Image 1 æ ‡è®°ï¼ˆä»£è¡¨ä¸»ä½“ï¼‰
```

---

### ä¹å®«æ ¼åˆ†é•œè¾“å‡ºæ ¼å¼

æ¯ä¸ªé•œå¤´é¢å¤–æ ‡æ³¨ç½‘æ ¼ä½ç½®ï¼š

```markdown
## é•œå¤´ N | æ—¶é•¿ | æ™¯åˆ«
**ä½ç½®:** ä¹å®«æ ¼ [è¡Œ,åˆ—]
**è½¬åœº:** [è½¬åœºç±»å‹]
**è¿é•œ:** [è¿é•œç±»å‹]

**æç¤ºè¯:**
[æ ‡å‡†4æ®µå¼æç¤ºè¯]
```

### è¾“å‡ºç»“å°¾é™„åŠ ä½ç½®å‚è€ƒ

```markdown
## ä¹å®«æ ¼ä½ç½®å‚è€ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é•œå¤´ 1  â”‚ é•œå¤´ 2  â”‚ é•œå¤´ 3  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é•œå¤´ 4  â”‚ é•œå¤´ 5  â”‚ é•œå¤´ 6  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é•œå¤´ 7  â”‚ é•œå¤´ 8  â”‚ é•œå¤´ 9  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é˜…è¯»é¡ºåº: 1â†’2â†’3â†’4â†’5â†’6â†’7â†’8â†’9
```
```

---

## å·¥ä½œæµç¨‹æ¦‚è§ˆ

```
ç”¨æˆ·è¾“å…¥ï¼ˆæ•…äº‹æè¿° + å¤šå¼ å›¾ç‰‡/ä¹å®«æ ¼å›¾ï¼‰
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç½®: ä¹å®«æ ¼æ£€æµ‹                    â”‚
â”‚  (å¦‚æœæ˜¯åˆæˆå›¾ï¼Œè¯¢é—®å¹¶è™šæ‹Ÿæ‹†åˆ†)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç½®: åŠ¨æ€å­¦ä¹ æ£€æŸ¥                  â”‚
â”‚  (æœç´¢ç›®æ ‡å¹³å°æœ€æ–°æŒ‡å—)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step B1: åˆ†é•œè§„åˆ’                  â”‚
â”‚  - åˆ†æå™äº‹ç»“æ„                     â”‚
â”‚  - è§„åˆ’æ™¯åˆ«åˆ†å¸ƒ                     â”‚
â”‚  - é€‰æ‹©è½¬åœºç±»å‹                     â”‚
â”‚  - ç¡®å®šæ—¶é•¿åˆ†é…                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step B2: å¾ªç¯ç”Ÿæˆ                  â”‚
â”‚  - å¯¹æ¯å¼ å›¾/æ¯ä¸ªæ ¼å­æ‰§è¡Œ Step 1-3   â”‚
â”‚  - æ·»åŠ é•œå¤´ç¼–å·å’Œè½¬åœº               â”‚
â”‚  - ä¹å®«æ ¼æ·»åŠ ä½ç½®æ ‡æ³¨               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step B3: æ•´åˆè¾“å‡º                  â”‚
â”‚  - æ±‡æ€»ä¸ºå®Œæ•´è„šæœ¬                   â”‚
â”‚  - æ·»åŠ æ•´ä½“å¤‡æ³¨                     â”‚
â”‚  - ä¹å®«æ ¼æ·»åŠ ä½ç½®å‚è€ƒå›¾             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    è¾“å‡º: å®Œæ•´åˆ†é•œè„šæœ¬
```

---

## å‰ç½®: åŠ¨æ€å­¦ä¹ æ£€æŸ¥

### è§¦å‘æ¡ä»¶

```
IF ç”¨æˆ·æŒ‡å®šç›®æ ‡å¹³å° (Sora, Runway, Pika, ç­‰):
   â†’ æœç´¢: "[å¹³å°å] prompt guide [å½“å‰å¹´ä»½]"
   â†’ æœç´¢: "[å¹³å°å] camera movement keywords"

IF ç”¨æˆ·éœ€è¦ç‰¹å®šé£æ ¼æˆ–æŠ€æœ¯:
   â†’ æœç´¢: "[é£æ ¼] cinematography techniques"
   â†’ æœç´¢: "professional storyboard [é£æ ¼] [å½“å‰å¹´ä»½]"
```

### æ•´åˆæ–°çŸ¥è¯†

```
1. è·å–æœç´¢ç»“æœ
2. æå–å…³é”®è¯å’Œç»“æ„å»ºè®®
3. ä¸æœ¬åœ°çŸ¥è¯†åº“åˆå¹¶
4. ä¼˜å…ˆä½¿ç”¨å¹³å°å®˜æ–¹æ¨èçš„å…³é”®è¯
5. åœ¨è¾“å‡ºä¸­æ ‡æ³¨çŸ¥è¯†æ¥æº
```

---

## Step B1: åˆ†é•œè§„åˆ’

### è¾“å…¥

```
- ç”¨æˆ·æ•…äº‹/åœºæ™¯æè¿°
- å¤šå¼ å›¾ç‰‡ (3-12 å¼ )
- ç›®æ ‡å¹³å° (å¯é€‰)
- æ•´ä½“é£æ ¼ (å¯é€‰)
```

### å¤„ç†é€»è¾‘

#### B1.1 å›¾ç‰‡å†…å®¹åˆ†æ

```
FOR i, image IN enumerate(images):
   analysis[i] = {
     "shot_type": detect_shot_type(image),      # è¿œæ™¯/ä¸­æ™¯/è¿‘æ™¯/ç‰¹å†™
     "subject": detect_subjects(image),          # äººç‰©/ç‰©ä½“
     "mood": detect_mood(image),                 # æƒ…æ„ŸåŸºè°ƒ
     "environment": detect_environment(image),   # ç¯å¢ƒç±»å‹
     "suggested_order": infer_narrative_order()  # æ¨æ–­å™äº‹é¡ºåº
   }
```

#### B1.2 å™äº‹ç»“æ„é€‰æ‹©

```
æ ¹æ®å›¾ç‰‡æ•°é‡å’Œå†…å®¹é€‰æ‹©ç»“æ„:

IF å›¾ç‰‡æ•° == 3-5:
   â†’ structure = "ä¸‰å¹•å¼"
   â†’ pattern: å¼€ç«¯(1-2) â†’ å‘å±•(1-2) â†’ ç»“å±€(1)

IF å›¾ç‰‡æ•° == 5-9 AND æ— æ˜æ˜¾å™äº‹çº¿:
   â†’ structure = "è’™å¤ªå¥‡å¼"
   â†’ pattern: ä¸»é¢˜ç»Ÿä¸€ï¼Œè§†è§‰å…³è”

IF å›¾ç‰‡æ•° >= 7 AND æœ‰å™äº‹çº¿:
   â†’ structure = "æ•…äº‹å¼"
   â†’ pattern: å¼€åœº â†’ ä»‹ç» â†’ è§¦å‘ â†’ å‘å±• â†’ é«˜æ½® â†’ ç»“å±€
```

#### B1.3 æ™¯åˆ«åˆ†å¸ƒè§„åˆ’

```
æ ¹æ®ç»å…¸èŠ‚å¥å…¬å¼åˆ†é…:

è¿œæ™¯ â†’ ä¸­æ™¯ â†’ è¿‘æ™¯ â†’ ç‰¹å†™ â†’ ä¸­æ™¯ â†’ è¿œæ™¯

å…·ä½“åˆ†é…:
- é•œå¤´ 1: è¿œæ™¯ (Establishing)
- é•œå¤´ 2-3: ä¸­æ™¯ (Development)
- é•œå¤´ N/2: è¿‘æ™¯/ç‰¹å†™ (Climax)
- é•œå¤´ N-1: ä¸­æ™¯ (Resolution)
- é•œå¤´ N: è¿œ/ä¸­æ™¯ (Ending)
```

#### B1.4 æ—¶é•¿åˆ†é…

```
æ ¹æ®é•œå¤´ç±»å‹åˆ†é…æ—¶é•¿:

shot_durations = {
  "establishing": 3-5,   # ç§’
  "medium": 2-4,
  "close_up": 1-3,
  "action": 2-4,
  "emotional": 3-5
}

total_duration = sum(shot_durations)
```

#### B1.5 è½¬åœºé€‰æ‹©

```
æ ¹æ®å™äº‹éœ€æ±‚é€‰æ‹©è½¬åœº:

IF æ—¶é—´è·³è·ƒ:
   â†’ "Dissolve" æˆ– "Fade to Black"

IF ç´§å¼ èŠ‚å¥:
   â†’ "Hard Cut" æˆ– "Jump Cut"

IF æƒ…æ„Ÿè¿æ¥:
   â†’ "Dissolve"

IF å¼€åœº:
   â†’ "Fade In"

IF ç»“å°¾:
   â†’ "Fade Out"

DEFAULT:
   â†’ "Cut"
```

### è¾“å‡º: åˆ†é•œç»“æ„è¡¨

```json
{
  "total_duration": 25,
  "shot_count": 5,
  "structure_type": "ä¸‰å¹•å¼",
  "overall_style": "æ–‡è‰º/æ…¢èŠ‚å¥",
  "shots": [
    {
      "shot_number": 1,
      "image_ref": "img_001",
      "shot_type": "establishing",
      "framing": "è¿œæ™¯",
      "duration": 4,
      "transition_in": "fade_in",
      "suggested_movement": "Slow Crane Down",
      "narrative_role": "å¼€åœºå»ºç«‹"
    },
    {
      "shot_number": 2,
      "image_ref": "img_002",
      "shot_type": "medium",
      "framing": "ä¸­æ™¯",
      "duration": 3,
      "transition_in": "dissolve",
      "suggested_movement": "Gentle Dolly In",
      "narrative_role": "äººç‰©ä»‹ç»"
    },
    ...
  ]
}
```

---

## Step B2: å¾ªç¯ç”Ÿæˆ

### å¤„ç†é€»è¾‘

```
FOR shot IN storyboard_plan.shots:
   
   # 1. æ‰§è¡Œ Step 1: åˆ†æçº¦æŸ
   analysis = step1_analyze(
     description=shot.description,
     image=shot.image,
     dialogues=shot.dialogues
   )
   
   # 2. æ‰§è¡Œ Step 2: è¿é•œæ¨è
   # ç»“åˆåˆ†é•œè§„åˆ’çš„æ™¯åˆ«è¦æ±‚
   recommendations = step2_recommend(
     analysis=analysis,
     suggested_movement=shot.suggested_movement,
     framing=shot.framing
   )
   
   # 3. ä½¿ç”¨æ¨èçš„é¦–é€‰è¿é•œ
   selected_movement = recommendations[0]
   
   # 4. æ‰§è¡Œ Step 3: ç”Ÿæˆæç¤ºè¯
   prompt_result = step3_generate(
     movement=selected_movement,
     language_code=analysis.language_code,
     image_mapping={shot.image_ref: f"Image {shot.shot_number}"},
     description=shot.description,
     dialogues=shot.dialogues
   )
   
   # 5. æ·»åŠ åˆ†é•œå…ƒæ•°æ®
   shot_output = {
     "shot_number": shot.shot_number,
     "duration": shot.duration,
     "framing": shot.framing,
     "transition": shot.transition_in,
     "movement": selected_movement.en_term,
     "prompt": prompt_result.final_prompt,
     "validation": prompt_result.validation
   }
   
   outputs.append(shot_output)
```

### å•é•œå¤´è¾“å‡ºæ ¼å¼

```markdown
## é•œå¤´ 1 | 4ç§’ | è¿œæ™¯
**è½¬åœº:** æ·¡å…¥ (Fade In)
**è¿é•œ:** Slow Crane Down

**æç¤ºè¯:**
```
Melancholic establishing shot, train station at dusk.

Camera Movement: Crane slowly descends through mist, revealing the empty platform.

Subject & Action: Image 1 stands alone at the edge of platform, silhouette against golden light.

Environment & Mood: Golden hour sunlight streaming through windows. Steam rising from tracks.
```
```

---

## Step B3: æ•´åˆè¾“å‡º

### å¤„ç†é€»è¾‘

```
1. ç»„è£…è„šæœ¬å¤´éƒ¨
   - é¡¹ç›®åç§°
   - æ€»æ—¶é•¿
   - é•œå¤´æ•°
   - æ•´ä½“é£æ ¼
   - ç›®æ ‡å¹³å°

2. æŒ‰é¡ºåºæ’åˆ—æ‰€æœ‰é•œå¤´
   - æ¯ä¸ªé•œå¤´ä½¿ç”¨æ ‡å‡†æ ¼å¼
   - åŒ…å«è½¬åœºæ ‡æ³¨
   - åŒ…å«æ—¶é•¿

3. æ·»åŠ æ•´ä½“å¤‡æ³¨
   - éŸ³ä¹å»ºè®®
   - è‰²è°ƒç»Ÿä¸€å»ºè®®
   - èŠ‚å¥æ§åˆ¶å»ºè®®

4. æœ€ç»ˆéªŒè¯
   - æ£€æŸ¥æ‰€æœ‰é•œå¤´çš„ Image ç¼–å·
   - æ£€æŸ¥æ‰€æœ‰å°è¯è¯­è¨€ä¿ç•™
   - æ£€æŸ¥æ— åˆ›æ„è¡¥å……
```

### è¾“å‡º: å®Œæ•´åˆ†é•œè„šæœ¬

```markdown
# [é¡¹ç›®åç§°] åˆ†é•œè„šæœ¬

**æ€»æ—¶é•¿:** 18 ç§’ | **é•œå¤´æ•°:** 4 | **é£æ ¼:** æ–‡è‰º/æ…¢èŠ‚å¥
**ç›®æ ‡å¹³å°:** Runway Gen-4

---

## é•œå¤´ 1 | 4ç§’ | è¿œæ™¯
**è½¬åœº:** æ·¡å…¥ (Fade In)
**è¿é•œ:** Slow Crane Down

**æç¤ºè¯:**
```
Melancholic establishing shot, train station platform at dusk.

Camera Movement: Crane slowly descends through atmospheric mist, revealing the empty platform, steady cinematic movement.

Subject & Action: Image 1 stands alone at the edge of platform, silhouette against golden light, motionless, waiting.

Environment & Mood: Golden hour sunlight streaming through high windows. Steam rising from distant tracks. Nostalgic, bittersweet atmosphere with warm amber tones.
```

---

## é•œå¤´ 2 | 3ç§’ | è¿‘æ™¯
**è½¬åœº:** å åŒ– (Dissolve)
**è¿é•œ:** Gentle Dolly In

**æç¤ºè¯:**
```
Emotional close-up, intimate farewell moment.

Camera Movement: Camera gently pushes toward Image 1's face, subtle handheld movement adding intimacy and vulnerability.

Subject & Action: Image 1 turns slightly toward camera, eyes glistening with unshed tears, whispers "å†è§" with a small, sad smile.

Environment & Mood: Soft backlight creates rim lighting around hair. Shallow depth of field blurs background. Warm but deeply melancholic.
```

---

## é•œå¤´ 3 | 5ç§’ | ä¸­æ™¯
**è½¬åœº:** åˆ‡æ¢ (Cut)
**è¿é•œ:** Slow Arc

**æç¤ºè¯:**
```
Contemplative medium shot, memories flooding back.

Camera Movement: Camera slowly arcs around Image 1, revealing the empty platform behind them, smooth orbital movement.

Subject & Action: Image 1 lowers their gaze, hand touching the bench beside them, lost in thought.

Environment & Mood: Platform empties around them. Distant train announcement echoes. Light transitioning from warm to cooler tones. Sense of time passing.
```

---

## é•œå¤´ 4 | 6ç§’ | è¿œæ™¯
**è½¬åœº:** å åŒ– â†’ æ·¡å‡º
**è¿é•œ:** Static â†’ Slow Zoom Out

**æç¤ºè¯:**
```
Poignant ending shot, isolation and acceptance emphasized.

Camera Movement: Static shot holding on Image 1, then slowly zooms out to isolate the small figure on the vast, empty platform.

Subject & Action: Image 1 watches as an unseen train departs, hand slowly lowering from a wave, shoulders dropping with release.

Environment & Mood: Platform completely empty now. Golden light faded to cool blue twilight. Gradual fade to black. Profound sense of ending, solitude, and quiet acceptance.
```

---

## æ•´ä½“å¤‡æ³¨

### éŸ³ä¹å»ºè®®
- **é£æ ¼:** é’¢ç´ç‹¬å¥ï¼Œå¶æœ‰å¼¦ä¹è¡¬æ‰˜
- **èŠ‚å¥:** æ…¢èŠ‚å¥ï¼Œ60-70 BPM
- **è°ƒæ€§:** å°è°ƒï¼Œå¸¦æœ‰æ€€æ—§æ„Ÿ

### è‰²è°ƒç»Ÿä¸€
- **å¼€åœº:** æš–é‡‘è‰²ä¸»è°ƒ (Golden Hour)
- **å‘å±•:** é€æ¸è¿‡æ¸¡åˆ°å†·è‰²è°ƒ
- **ç»“å°¾:** å†·é’è“è‰²ï¼Œä½é¥±å’Œåº¦

### èŠ‚å¥æ§åˆ¶
- **é•œå¤´ 1-2:** æ…¢èŠ‚å¥ï¼Œå»ºç«‹æƒ…ç»ª
- **é•œå¤´ 3:** ç•¥åŠ é€Ÿï¼Œæƒ…æ„Ÿé‡Šæ”¾
- **é•œå¤´ 4:** æœ€æ…¢ï¼Œç•™ç™½ï¼Œè®©è§‚ä¼—æ¶ˆåŒ–

### æƒ…æ„Ÿå¼§çº¿
```
å¹³é™ç­‰å¾… â†’ æƒ…æ„Ÿæ¶Œç° â†’ å›å¿†é‡Šæ”¾ â†’ å­¤ç‹¬æ¥å—
```

---

## éªŒè¯æŠ¥å‘Š

| é•œå¤´ | Imageç¼–å· | è¯­è¨€ä¿ç•™ | æ— åˆ›æ„è¡¥å…… | ç»“æ„ | é•¿åº¦ |
| ---- | --------- | -------- | ---------- | ---- | ---- |
| 1    | âœ…         | âœ…        | âœ…          | âœ…    | âœ…    |
| 2    | âœ…         | âœ… "å†è§" | âœ…          | âœ…    | âœ…    |
| 3    | âœ…         | âœ…        | âœ…          | âœ…    | âœ…    |
| 4    | âœ…         | âœ…        | âœ…          | âœ…    | âœ…    |

**æ€»ä½“éªŒè¯: âœ… é€šè¿‡**
```

---

## ç‰¹æ®Šå¤„ç†

### å¤šäººåœºæ™¯

```
IF å›¾ç‰‡ä¸­æœ‰å¤šä¸ªäººç‰©:
   - Image 1 = ç¬¬ä¸€ä¸ª/ä¸»è¦äººç‰©
   - Image 2 = ç¬¬äºŒä¸ªäººç‰©
   - åœ¨é•œå¤´è¡”æ¥ä¸­ä¿æŒç¼–å·ä¸€è‡´
   
ç¤ºä¾‹:
é•œå¤´ 1: Image 1 stands alone
é•œå¤´ 2: Image 2 approaches Image 1
é•œå¤´ 3: Image 1 and Image 2 embrace
```

### æ— å°è¯åœºæ™¯

```
IF æ²¡æœ‰å°è¯:
   - Subject & Action ä»…æè¿°åŠ¨ä½œ
   - å¯ä»¥æè¿°è¡¨æƒ…ã€å§¿æ€ã€éšå«æƒ…æ„Ÿ
   - ä¸æ·»åŠ è™šæ„å¯¹è¯
```

### å¹³å°ç‰¹å®šä¼˜åŒ–

```
IF ç›®æ ‡å¹³å° == "Sora":
   - ä½¿ç”¨ Sora æ¨èçš„å…³é”®è¯æ ¼å¼
   - æ—¶é—´èŠ‚æ‹æ ¼å¼: [0-3s], [3-5s]

IF ç›®æ ‡å¹³å° == "Runway":
   - ä½¿ç”¨ Runway Gen-4 çš„ Subject Motion ç»“æ„
   - æ·»åŠ  Motion å‚æ•°å»ºè®®

IF ç›®æ ‡å¹³å° == "Pika":
   - æ·»åŠ  -neg è´Ÿé¢æç¤ºè¯å»ºè®®
   - å»ºè®® -gs, -ar å‚æ•°
```
